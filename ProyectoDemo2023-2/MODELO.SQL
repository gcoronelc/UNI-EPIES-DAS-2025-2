
USE DBFLORES
go





CREATE TABLE dbo.TIPO_DOC
( 
	IDTIPODOC            integer IDENTITY ( 1,1 ) ,
	DESCRIPCION          varchar(100)  NOT NULL ,
	DESCORTA             varchar(20)  NOT NULL ,
	CONSTRAINT XPKTIPO_DOC PRIMARY KEY (IDTIPODOC ASC)
)
go



CREATE TABLE dbo.CLIENTE
( 
	IDCLIENTE            integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(150)  NOT NULL ,
	IDTIPODOC            integer  NOT NULL ,
	NRODOC               varchar(20)  NOT NULL ,
	CONSTRAINT XPKCLIENTE PRIMARY KEY (IDCLIENTE ASC),
	CONSTRAINT FK_CLIENTE_TIPO_DOC FOREIGN KEY (IDTIPODOC) REFERENCES dbo.TIPO_DOC(IDTIPODOC)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.EMPLEADO
( 
	IDEMPLEADO           integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(150)  NOT NULL ,
	IDTIPODOC            integer  NOT NULL ,
	NRODOC               varchar(20)  NOT NULL ,
	CONSTRAINT XPKEMPLEADO PRIMARY KEY (IDEMPLEADO ASC),
	CONSTRAINT FK_EMPLEADO_TIPO_DOC FOREIGN KEY (IDTIPODOC) REFERENCES dbo.TIPO_DOC(IDTIPODOC)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.ESTADO_VENTA
( 
	IDESTADO             integer  NOT NULL ,
	NOMBRE               varchar(20)  NOT NULL ,
	DESCRIPCION          varchar(200)  NOT NULL ,
	CONSTRAINT XPKESTADO_VENTA PRIMARY KEY (IDESTADO ASC)
)
go



CREATE TABLE dbo.VENTA
( 
	IDVENTA              integer IDENTITY ( 1,1 ) ,
	IDESTADO             integer  NOT NULL ,
	IDCLIENTE            integer  NOT NULL ,
	VENDEDOR             integer  NOT NULL ,
	CAJERO               integer  NULL ,
	FECHAVENTA           datetime  NOT NULL ,
	FECHAPAGO            datetime  NULL ,
	SUBTOTAL             numeric(12,2)  NOT NULL ,
	IMPUESTO             numeric(12,2)  NOT NULL ,
	TOTAL                numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKVENTA PRIMARY KEY (IDVENTA ASC),
	CONSTRAINT FK_VENTA_CLIENTE FOREIGN KEY (IDCLIENTE) REFERENCES dbo.CLIENTE(IDCLIENTE)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_VENTA_VENDEDOR FOREIGN KEY (VENDEDOR) REFERENCES dbo.EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_VENTA_CAJERO FOREIGN KEY (CAJERO) REFERENCES dbo.EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_VENTA_ESTADO_VENTA FOREIGN KEY (IDESTADO) REFERENCES dbo.ESTADO_VENTA(IDESTADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.CATEGORIA
( 
	IDCATEGORIA          integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(150)  NOT NULL ,
	NOMBCORTO            varchar(20)  NOT NULL ,
	CONSTRAINT XPKCATEGORIA PRIMARY KEY (IDCATEGORIA ASC)
)
go



CREATE TABLE dbo.PRODUCTO
( 
	IDPRODUCTO           integer IDENTITY ( 1,1 ) ,
	IDCATEGORIA          integer  NOT NULL ,
	NOMBRE               varchar(200)  NOT NULL ,
	STOCK                integer  NOT NULL ,
	PRECOSTO             numeric(12,2)  NOT NULL ,
	PREVENTA             numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKPRODUCTO PRIMARY KEY (IDPRODUCTO ASC),
	CONSTRAINT FK_PRODUCTO_CATEGORIA FOREIGN KEY (IDCATEGORIA) REFERENCES dbo.CATEGORIA(IDCATEGORIA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE dbo.DETALLE_VENTA
( 
	IDDETALLE            integer IDENTITY ( 1,1 ) ,
	IDVENTA              integer  NOT NULL ,
	IDPRODUCTO           integer  NOT NULL ,
	PREVENTA             numeric(12,2)  NOT NULL ,
	CANTIDAD             integer  NOT NULL ,
	SUBTOTAL             numeric(12,2)  NOT NULL ,
	CONSTRAINT XPKDETALLE_VENTA PRIMARY KEY (IDDETALLE ASC),
	CONSTRAINT XAK1DETALLE_VENTA UNIQUE (IDVENTA  ASC,IDPRODUCTO  ASC),
	CONSTRAINT DETALLE_VENTA_VENTA FOREIGN KEY (IDVENTA) REFERENCES dbo.VENTA(IDVENTA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_DETALLE_VENTA_PRODUCTO FOREIGN KEY (IDPRODUCTO) REFERENCES dbo.PRODUCTO(IDPRODUCTO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go


