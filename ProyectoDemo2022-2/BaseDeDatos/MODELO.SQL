
CREATE TABLE CIUDAD
( 
	IDCIUDAD             integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	DIRECCION            varchar(200)  NOT NULL ,
	ADMINISTRADOR        varchar(20)  NOT NULL ,
	CONSTRAINT XPKCIUDAD PRIMARY KEY (IDCIUDAD ASC)
)
go



CREATE TABLE CARGO
( 
	IDCARGO              integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	CONSTRAINT XPKCARGO PRIMARY KEY (IDCARGO ASC)
)
go



CREATE TABLE EMPLEADO
( 
	IDEMPLEADO           integer IDENTITY ( 1,1 ) ,
	NOMBRE               varchar(100)  NOT NULL ,
	APELLIDO             varchar(100)  NOT NULL ,
	DISTRITO             varchar(60)  NOT NULL ,
	CORREO               varchar(60)  NOT NULL ,
	TELEFONO             varchar(20)  NOT NULL ,
	ACTIVO               integer  NOT NULL 
	CONSTRAINT DF_EMPLEADO_ACTIVO
		 DEFAULT  1
	CONSTRAINT CK_EMPLEADO_ACTIVO
		CHECK  ( [ACTIVO]=0 OR [ACTIVO]=1 ),
	IDCARGO              integer  NOT NULL ,
	CONSTRAINT XPKEMPLEADO PRIMARY KEY (IDEMPLEADO ASC),
	CONSTRAINT FK_EMPLEADO_CARGO FOREIGN KEY (IDCARGO) REFERENCES CARGO(IDCARGO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE ROL
( 
	IDROL                integer  NOT NULL ,
	NOMBRE               varchar(60)  NOT NULL ,
	CONSTRAINT XPKROL PRIMARY KEY (IDROL ASC)
)
go



CREATE TABLE USUARIO
( 
	IDEMPLEADO           integer  NOT NULL ,
	USUARIO              varchar(60)  NOT NULL ,
	CLAVE                varchar(60)  NOT NULL ,
	IDROL                integer  NOT NULL ,
	ACTIVO               integer  NOT NULL 
	CONSTRAINT DF_USUARIO_ACTIVO
		 DEFAULT  1
	CONSTRAINT CK_USUARIO_ACTIVO
		CHECK  ( [ACTIVO]=0 OR [ACTIVO]=1 ),
	CONSTRAINT XPKUSUARIO PRIMARY KEY (IDEMPLEADO ASC),
	CONSTRAINT FK_USUARIO_EMPLEADO FOREIGN KEY (IDEMPLEADO) REFERENCES EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_USUARIO_ROL FOREIGN KEY (IDROL) REFERENCES ROL(IDROL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE RUTA
( 
	IDRUTA               integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	ORIGEN               integer  NOT NULL ,
	DESTINO              integer  NOT NULL ,
	DURACION             varchar(20)  NOT NULL ,
	PRECIO1              money  NOT NULL ,
	PRECIO2              money  NOT NULL ,
	PRECIO3              integer  NOT NULL ,
	IDEMPLEADO           integer  NOT NULL ,
	CONSTRAINT XPKRUTA PRIMARY KEY (IDRUTA ASC),
	CONSTRAINT FK_RUTA_CIUDAD_ORIGEN FOREIGN KEY (ORIGEN) REFERENCES CIUDAD(IDCIUDAD)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_RUTA_CIUDAD_DESTINO FOREIGN KEY (DESTINO) REFERENCES CIUDAD(IDCIUDAD)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_RUTA_USUARIO FOREIGN KEY (IDEMPLEADO) REFERENCES USUARIO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE BUS
( 
	IDBUS                integer  NOT NULL ,
	CODIGO               varchar(50)  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	PLACA                varchar(20)  NOT NULL ,
	CAPACIDAD_PRECIO1    integer  NOT NULL ,
	CAPACIDAD_PRECIO2    integer  NOT NULL ,
	CAPACIDAD_PRECIO3    integer  NOT NULL ,
	CONSTRAINT XPKBUS PRIMARY KEY (IDBUS ASC)
)
go



CREATE TABLE PROGRAMACION
( 
	IDPROG               integer  NOT NULL ,
	IDRUTA               integer  NOT NULL ,
	FECHA_SALIDA         datetime  NOT NULL ,
	HORA_SALIDA          varchar(20)  NOT NULL ,
	FECHA_LLEGADA        datetime  NOT NULL ,
	HORA_LLEGADA         varchar(20)  NOT NULL ,
	IDBUS                integer  NOT NULL ,
	PRECIO1              money  NOT NULL ,
	PRECIO2              money  NOT NULL ,
	PRECIO3              integer  NOT NULL ,
	ASIENTOS_PRECIO1     integer  NULL ,
	ASIENTOS_PRECIO2     integer  NULL ,
	ASIENTOS_PRECIO3     integer  NULL ,
	IDEMPLEADO           integer  NOT NULL ,
	CONSTRAINT XPKPROGRAMACION PRIMARY KEY (IDPROG ASC),
	CONSTRAINT FK_PROGRAMACION_RUTA FOREIGN KEY (IDRUTA) REFERENCES RUTA(IDRUTA)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_PROGRAMACION_BUS FOREIGN KEY (IDBUS) REFERENCES BUS(IDBUS)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_PROGRAMACION_USUARIO FOREIGN KEY (IDEMPLEADO) REFERENCES USUARIO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE CLIENTE
( 
	IDCLIENTE            integer  NOT NULL ,
	NOMBRE               varchar(100)  NOT NULL ,
	APELLIDO             varchar(100)  NOT NULL ,
	DNI                  varchar(20)  NULL ,
	DISTRITO             varchar(60)  NOT NULL ,
	CORREO               varchar(60)  NOT NULL ,
	TELEFONO             varchar(20)  NOT NULL ,
	CONSTRAINT XPKCLIENTE PRIMARY KEY (IDCLIENTE ASC)
)
go



CREATE TABLE VENTA
( 
	IDVENTA              integer  NOT NULL ,
	IDPROG               integer  NOT NULL ,
	IDCLIENTE            integer  NOT NULL ,
	TIPO                 varchar(20)  NOT NULL ,
	PRECIO               money  NOT NULL ,
	NOMBRE_VIAJERO       varchar(100)  NOT NULL ,
	APELLIDO_VIAJERO     varchar(20)  NOT NULL ,
	DNI_VIAJERO          varchar(20)  NOT NULL ,
	IDEMPLEADO           integer  NOT NULL ,
	CONSTRAINT XPKVENTA PRIMARY KEY (IDVENTA ASC),
	CONSTRAINT FK_VENTA_PROGRAMACION FOREIGN KEY (IDPROG) REFERENCES PROGRAMACION(IDPROG)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_VENTA_CLIENTE FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE(IDCLIENTE)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_VENTA_EMPLEADO FOREIGN KEY (IDEMPLEADO) REFERENCES EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE ROL_TRIPULANTE
( 
	IDROL                integer  NOT NULL ,
	NOMBRE               varchar(50)  NOT NULL ,
	CONSTRAINT XPKROL_TRIPULANTE PRIMARY KEY (IDROL ASC)
)
go



CREATE TABLE TRIPULACION
( 
	IDTRIPULACION        integer  NOT NULL ,
	IDPROG               integer  NOT NULL ,
	IDEMPLEADO           integer  NOT NULL ,
	IDROL                integer  NOT NULL ,
	CONSTRAINT XPKTRIPULACION PRIMARY KEY (IDTRIPULACION ASC),
	CONSTRAINT FK_TRIPULACION_PROGRAMACION FOREIGN KEY (IDPROG) REFERENCES PROGRAMACION(IDPROG)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_TRIPULACION_EMPLEADO FOREIGN KEY (IDEMPLEADO) REFERENCES EMPLEADO(IDEMPLEADO)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION,
CONSTRAINT FK_TRIPULACION_ROL FOREIGN KEY (IDROL) REFERENCES ROL_TRIPULANTE(IDROL)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
)
go



CREATE TABLE PARAMETRO
( 
	IDPARAMETRO          integer  NOT NULL ,
	DESCRIPCION          varchar(200)  NOT NULL ,
	VALOR                varchar(200)  NOT NULL ,
	CONSTRAINT XPKPARAMETRO PRIMARY KEY (IDPARAMETRO ASC)
)
go



CREATE TABLE CONTADOR
( 
	IDCONTADOR           integer  NOT NULL ,
	TABLA                varchar(100)  NOT NULL ,
	ULTIMO               integer  NOT NULL ,
	CONSTRAINT XPKCONTADOR PRIMARY KEY (IDCONTADOR ASC)
)
go


